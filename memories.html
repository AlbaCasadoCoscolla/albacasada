<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <title>Memòries en Cendra — Alba Casada</title>
  <link rel="stylesheet" href="https://use.typekit.net/bim0due.css"/>
  <link rel="stylesheet" href="memories.css"/>
</head>
<body data-project-slug="memories-en-cendra">

  <!-- NAV (solo desktop/tablet) -->
  <nav aria-label="principal">
    <a href="index.html">Inicio</a>
    <a href="projects.html">Proyectos</a>
    <a href="about.html">Sobre mí</a>
  </nav>

  <!-- Menú móvil -->
  <header class="mobile-header">
    <button id="burgerBtn" class="burger" aria-label="Abrir menú" aria-controls="mobileOverlay" aria-expanded="false">
      <svg width="30" height="30" viewBox="0 0 24 24" fill="none" aria-hidden="true">
        <path d="M3 6h18M3 12h18M3 18h18" stroke="currentColor" stroke-width="4" stroke-linecap="round"/>
      </svg>
    </button>
  </header>

  <nav id="mobileOverlay" class="mobile-overlay" aria-hidden="true" role="dialog" aria-label="Menú móvil">
    <button id="closeMenu" class="close-menu" aria-label="Cerrar menú">
      <svg width="50" height="50" viewBox="0 0 24 24" fill="none" aria-hidden="true">
        <path d="M6 6l12 12M18 6l-12 12" stroke="currentColor" stroke-width="4" stroke-linecap="round"/>
      </svg>
    </button>
    <div class="mobile-menu-content">
      <button class="mobile-menu-btn" data-nav="projects.html">Proyectos</button>
      <button class="mobile-menu-btn" data-nav="about.html">Sobre mí</button>
    </div>
  </nav>

  <!-- Flechas navegación entre proyectos -->
  <button class="proj-nav proj-prev" id="projPrev" aria-label="Proyecto anterior" hidden>
    <span class="arrow">‹</span><span class="proj-tooltip" id="prevTip"></span>
  </button>
  <button class="proj-nav proj-next" id="projNext" aria-label="Proyecto siguiente" hidden>
    <span class="arrow">›</span><span class="proj-tooltip" id="nextTip"></span>
  </button>

  <main>
    <!-- HERO -->
    <section class="hero">
      <figure class="cover" aria-label="Imagen destacada del proyecto">
        <img src="media/galeria/mec/logomemories.png" alt="Portada de 'Memòries en Cendra'">
      </figure>

      <div class="hero-grid">
        <div class="summary">
          <p class="description">  <strong>Memòries en Cendra</strong> es una experiencia inmersiva de <strong>Realidad Virtual</strong> que invita a los usuarios a vivir el proceso de creación y celebración de las <strong>Fallas de Valencia</strong>.</p>
          <p class="lead"> El concepto central de la experiencia gira en torno al propio nombre que, con la figura de <strong>Cendra</strong>, el espíritu guía del juego, y junto a otros personajes que representan <strong>figuras de la cultura valenciana</strong>, guían al jugador a través de las diferentes misiones.</p>
          <div class="meta" aria-label="Software utilizado">
            <span class="badge"><img src="media/logos/blender.png" alt="Blender">Blender</span>
            <span class="badge"><img src="media/logos/unity.png" alt="Unity">Unity</span>
            <span class="badge"><img src="media/logos/photoshop.png" alt="Photoshop">Photoshop</span>
            <span class="badge"><img src="media/logos/preocreate.png" alt="Procreate">Procreate</span>
          </div>
        </div>

<figure class="hero-render" aria-label="Tráiler del proyecto">
  <a 
    href="https://www.youtube.com/watch?v=Lzyu43-8dig" 
    target="_blank" 
    rel="noopener noreferrer" 
    class="video-thumbnail"
    aria-label="Ver tráiler en YouTube">
    <img src="media/galeria/mec/portada_video.png" alt="Portada del tráiler de Memòries en Cendra">
    <div class="play-button" aria-hidden="true">▶</div>
  </a>
</figure>
      </div>
    </section>

    <!-- GALERÍA -->
    <section class="gallery masonry fullbleed is-collapsed" aria-label="Galería principal">
      <a class="pin" href="media/galeria/mec/render1.png"  data-gallery="renders"><img src="media/galeria/mec/render1.png"  alt="Vista 1"></a>
      <a class="pin" href="media/galeria/mec/render2.png"  data-gallery="renders"><img src="media/galeria/mec/render2.png"  alt="Vista 2"></a>
      <a class="pin" href="media/galeria/mec/render3.png"  data-gallery="renders"><img src="media/galeria/mec/render3.png"  alt="Vista 3"></a>
      <a class="pin" href="media/galeria/mec/render4.png"  data-gallery="renders"><img src="media/galeria/mec/render4.png"  alt="Vista 4"></a>
      <a class="pin" href="media/galeria/mec/render5.png"  data-gallery="renders"><img src="media/galeria/mec/render5.png"  alt="Vista 5"></a>
      <a class="pin" href="media/galeria/mec/render6.png"  data-gallery="renders"><img src="media/galeria/mec/render6.png"  alt="Vista 6"></a>
      <a class="pin" href="media/galeria/mec/render7.png"  data-gallery="renders"><img src="media/galeria/mec/render7.png"  alt="Vista 7"></a>
      <a class="pin" href="media/galeria/mec/render8.png"  data-gallery="renders"><img src="media/galeria/mec/render8.png"  alt="Vista 8"></a>
      <a class="pin" href="media/galeria/mec/render9.png"  data-gallery="renders"><img src="media/galeria/mec/render9.png"  alt="Vista 9"></a>
      <a class="pin" href="media/galeria/mec/render10.png" data-gallery="renders"><img src="media/galeria/mec/render10.png" alt="Vista 10"></a>
      <a class="pin" href="media/galeria/mec/render11.png" data-gallery="renders"><img src="media/galeria/mec/render11.png" alt="Vista 11"></a>
      <a class="pin" href="media/galeria/mec/render12.png" data-gallery="renders"><img src="media/galeria/mec/render12.png" alt="Vista 12"></a>
    </section>

    <button class="gallery-toggle" id="galleryToggle" aria-expanded="false">Ver más</button>

    <!-- EQUIPO -->
    <section class="team" aria-label="Equipo del proyecto">
      <h2>Equipo</h2>
      <p class="intro">Somos un equipo multidisciplinar centrado en la creación de experiencias narrativas y visuales en Realidad Virtual, que aúnan tradición y tecnología para acercar la cultura a las nuevas generaciones.</p>

      <div class="team-grid">
        <figure class="member">
          <img class="avatar" src="media/galeria/mec/alba.jpg" alt="Alba Casado Coscollá">
          <figcaption><div class="name">Alba Casado Coscollá</div><div class="role">Coordinación general, Dirección creativa, Coordinación 3D y Artista 2D/3D</div></figcaption>
        </figure>
        <figure class="member">
          <img class="avatar" src="media/galeria/mec/maria.png" alt="María Moreno Martínez">
          <figcaption><div class="name">María Moreno Martínez</div><div class="role">Coordinación general, Responsable de Redes Sociales y Artista 2D/3D</div></figcaption>
        </figure>
        <figure class="member">
          <img class="avatar" src="media/galeria/mec/celia.JPG" alt="Celia García Monforte">
          <figcaption><div class="name">Celia García Monforte</div><div class="role">Programación en Unity y Web, Responsable de comunicación externa</div></figcaption>
        </figure>
        <figure class="member">
          <img class="avatar" src="media/galeria/mec/joel.JPG" alt="Joel Revert Vila">
          <figcaption><div class="name">Joel Revert Vila</div><div class="role">Coordinación de programación, Programador en Unity y Web</div></figcaption>
        </figure>
      </div>

      <div class="my-role">
        <p>Concretamente en este proyecto me ocupo de la supervisión y organización general, desarrollo el arte visual e ilustraciones principales, coordino al equipo de 3D con Unity y participo en la creación de assets y animaciones, además de apoyar en redes y edición de vídeo.</p>
      </div>
    </section>

    <!-- PROCESO -->
    <section class="process proc-scroll" aria-label="Proceso y bocetos">
      <h2>Proceso</h2>
      <div class="proc-stage" id="processStage" aria-live="polite" tabindex="0">
        <button class="proc-btn proc-prev" aria-label="Anterior">‹</button>
        <div class="proc-viewport">
          <div class="proc-track">
            <a class="proc-slide" href="media/galeria/mec/concept1.png"  data-gallery="concepts"><img src="media/galeria/mec/concept1.png"  alt="Boceto 1"></a>
            <a class="proc-slide" href="media/galeria/mec/concept2.png"  data-gallery="concepts"><img src="media/galeria/mec/concept2.png"  alt="Boceto 2"></a>
            <a class="proc-slide" href="media/galeria/mec/concept3.png"  data-gallery="concepts"><img src="media/galeria/mec/concept3.png"  alt="Boceto 3"></a>
            <a class="proc-slide" href="media/galeria/mec/concept4.png"  data-gallery="concepts"><img src="media/galeria/mec/concept4.png"  alt="Boceto 4"></a>
            <a class="proc-slide" href="media/galeria/mec/concept5.png"  data-gallery="concepts"><img src="media/galeria/mec/concept5.png"  alt="Boceto 5"></a>
            <a class="proc-slide" href="media/galeria/mec/concept6.png"  data-gallery="concepts"><img src="media/galeria/mec/concept6.png"  alt="Boceto 6"></a>
            <a class="proc-slide" href="media/galeria/mec/concept7.jpeg" data-gallery="concepts"><img src="media/galeria/mec/concept7.jpeg" alt="Boceto 7"></a>
            <a class="proc-slide" href="media/galeria/mec/concept8.png"  data-gallery="concepts"><img src="media/galeria/mec/concept8.png"  alt="Boceto 8"></a>
            <a class="proc-slide" href="media/galeria/mec/concept9.png"  data-gallery="concepts"><img src="media/galeria/mec/concept9.png"  alt="Boceto 9"></a>
            <a class="proc-slide" href="media/galeria/mec/concept10.png" data-gallery="concepts"><img src="media/galeria/mec/concept10.png" alt="Boceto 10"></a>
            <a class="proc-slide" href="media/galeria/mec/concept11.png" data-gallery="concepts"><img src="media/galeria/mec/concept11.png" alt="Boceto 11"></a>
          </div>
        </div>
        <button class="proc-btn proc-next" aria-label="Siguiente">›</button>
      </div>
      <p class="process-outro">Una muestra del proceso: bocetos, renders e ilustraciones incluidas en el juego.</p>
    </section>
  </main>

  <!-- Lightbox -->
  <div class="lightbox" id="lightbox" aria-modal="true" role="dialog" aria-label="Imagen ampliada" hidden>
    <div class="lb-frame">
      <img class="lb-img" id="lbImg" alt="Imagen ampliada">
      <button class="lb-close" id="lbClose" aria-label="Cerrar">✕</button>
      <button class="lb-prev" id="lbPrev" aria-label="Anterior">‹</button>
      <button class="lb-next" id="lbNext" aria-label="Siguiente">›</button>
    </div>
  </div>

  <script>
  /* ==========================
     Config
  ========================== */
  const PROJECTS = [
    { slug: 'memories-en-cendra', url: 'memories-en-cendra.html', title: 'Memories en Cendra' },
    { slug: 'demonyos',           url: 'demonyos.html',           title: 'Demonyos' },
    { slug: 'eklektik',           url: 'eklektik.html',           title: 'Eklektik' }
  ];

  document.addEventListener('DOMContentLoaded', () => {
    /* ==========================
       NAV entre proyectos
    ========================== */
    const currentSlug = document.body.getAttribute('data-project-slug');
    const currentIndex = PROJECTS.findIndex(p => p.slug === currentSlug);
    const btnPrev = document.getElementById('projPrev');
    const btnNext = document.getElementById('projNext');
    const tipPrev = document.getElementById('prevTip');
    const tipNext = document.getElementById('nextTip');

    if (currentIndex > 0 && btnPrev && tipPrev) {
      const prev = PROJECTS[currentIndex - 1];
      tipPrev.textContent = prev.title;
      btnPrev.hidden = false;
      btnPrev.addEventListener('click', () => { window.location.href = prev.url; });
    }
    if (currentIndex >= 0 && currentIndex < PROJECTS.length - 1 && btnNext && tipNext) {
      const next = PROJECTS[currentIndex + 1];
      tipNext.textContent = next.title;
      btnNext.hidden = false;
      btnNext.addEventListener('click', () => { window.location.href = next.url; });
    }

    /* ==========================
       LIGHTBOX
    ========================== */
    const lb = document.getElementById('lightbox');
    const lbImg = document.getElementById('lbImg');
    const btnClose = document.getElementById('lbClose');
    const btnPrevLb = document.getElementById('lbPrev');
    const btnNextLb = document.getElementById('lbNext');

    let group = '';
    let shots = [];
    let idx = 0;

    function collect(groupName){ return Array.from(document.querySelectorAll(`[data-gallery="${groupName}"]`)); }
    function openAt(a){
      group = a.getAttribute('data-gallery') || '';
      shots = collect(group);
      idx = shots.indexOf(a);
      if (idx < 0) idx = 0;
      update();
      lb.classList.add('open');
      lb.removeAttribute('hidden');
      // no bloqueamos el scroll global aquí porque el overlay móvil ya lo gestiona
    }
    function close(){
      lb.classList.remove('open');
      lb.setAttribute('hidden','');
    }
    function update(){
      const link = shots[idx];
      if (!link) return close();
      lbImg.src = link.getAttribute('href');
      const fallbackAlt = group === 'concepts' ? 'Concept' : 'Render';
      const imgEl = link.querySelector('img');
      lbImg.alt = (imgEl && imgEl.alt) ? imgEl.alt : `Imagen ampliada — ${fallbackAlt}`;
    }
    function prev(){ idx = (idx - 1 + shots.length) % shots.length; update(); }
    function next(){ idx = (idx + 1) % shots.length; update(); }

    document.querySelectorAll('[data-gallery]').forEach((a)=>{
      a.addEventListener('click', (e)=>{ e.preventDefault(); openAt(a); });
      a.setAttribute('role','button');
      a.setAttribute('tabindex','0');
    });

    btnClose.addEventListener('click', close);
    btnPrevLb.addEventListener('click', prev);
    btnNextLb.addEventListener('click', next);
    lb.addEventListener('click', (e)=>{ if(e.target===lb) close(); });
    document.addEventListener('keydown', (e)=>{
      if(lb.classList.contains('open')){
        if(e.key==='Escape') close();
        if(e.key==='ArrowLeft') prev();
        if(e.key==='ArrowRight') next();
      }
    });

    /* ==========================
       Galería: Ver más / Ver menos
    ========================== */
    const gallery = document.querySelector('.gallery.masonry.fullbleed');
    const galTog  = document.getElementById('galleryToggle');
    if (gallery && galTog){
      function setGal(expanded){
        gallery.classList.toggle('is-collapsed', !expanded);
        galTog.setAttribute('aria-expanded', String(expanded));
        galTog.textContent = expanded ? 'Ver menos' : 'Ver más';
      }
      setGal(false);
      galTog.addEventListener('click', ()=> setGal(galTog.getAttribute('aria-expanded') !== 'true'));
    }

    /* ==========================
       PROCESO (dos modos)
    ========================== */
    const proc = document.getElementById('processStage');
    if (proc && !proc.closest('.process').classList.contains('proc-scroll')){
      const viewport = proc.querySelector('.proc-viewport');
      const track = proc.querySelector('.proc-track');
      const slides = Array.from(track.querySelectorAll('.proc-slide'));
      const prevB = proc.querySelector('.proc-prev');
      const nextB = proc.querySelector('.proc-next');
      let i = 0;

      function slideWidth(){ return viewport.clientWidth; }
      function render(){
        const x = -i * slideWidth();
        track.style.transform = `translateX(${x}px)`;
        prevB.disabled = i === 0;
        nextB.disabled = i === slides.length - 1;
      }
      prevB.addEventListener('click', ()=>{ if(i>0){ i--; render(); } });
      nextB.addEventListener('click', ()=>{ if(i<slides.length-1){ i++; render(); } });
      window.addEventListener('resize', render);
      proc.addEventListener('keydown', (e)=>{
        if(e.key === 'ArrowLeft'){ e.preventDefault(); if(i>0){ i--; render(); } }
        if(e.key === 'ArrowRight'){ e.preventDefault(); if(i<slides.length-1){ i++; render(); } }
      });
      render();
    } else if (proc) {
      const viewport = proc.querySelector('.proc-viewport');
      proc.addEventListener('keydown', (e)=>{
        if (e.key === 'ArrowLeft'){ e.preventDefault(); viewport.scrollBy({ left: -viewport.clientWidth/1.05, behavior: 'smooth' }); }
        if (e.key === 'ArrowRight'){ e.preventDefault(); viewport.scrollBy({ left:  viewport.clientWidth/1.05, behavior: 'smooth' }); }
      });
      viewport.addEventListener('wheel', (e)=>{
        if (Math.abs(e.deltaY) > Math.abs(e.deltaX)) {
          e.preventDefault();
          viewport.scrollBy({ left: e.deltaY, behavior: 'auto' });
        }
      }, { passive: false });
      let isDown = false, startX = 0, startScroll = 0;
      const start = (x)=>{ isDown = true; startX = x; startScroll = viewport.scrollLeft; };
      const move  = (x)=>{ if(!isDown) return; viewport.scrollLeft = startScroll - (x - startX); };
      const stop  = ()=>{ isDown = false; };
      viewport.addEventListener('mousedown',  (e)=>{ start(e.pageX); });
      viewport.addEventListener('mousemove',  (e)=>{ move(e.pageX); });
      viewport.addEventListener('mouseleave', stop);
      viewport.addEventListener('mouseup',    stop);
      viewport.addEventListener('touchstart', (e)=>{ if(e.touches[0]) start(e.touches[0].pageX); }, {passive:true});
      viewport.addEventListener('touchmove',  (e)=>{ if(e.touches[0]) move(e.touches[0].pageX); },  {passive:true});
      viewport.addEventListener('touchend',   stop);
    }

    /* ==========================
       MENÚ MÓVIL (burger) + bloqueo de scroll
    ========================== */
    const burgerBtn = document.getElementById('burgerBtn');
    const mobileOverlay = document.getElementById('mobileOverlay');
    const closeMenu = document.getElementById('closeMenu');

    let scrollY = 0;

    function lockScroll(){
      // Guarda posición actual y bloquea scroll (iOS-friendly)
      scrollY = window.scrollY || document.documentElement.scrollTop || 0;
      document.documentElement.classList.add('is-locked');
      document.body.classList.add('is-locked');
      document.body.style.top = `-${scrollY}px`;
    }

    function unlockScroll(){
      // Restaura scroll exactamente donde estaba
      document.documentElement.classList.remove('is-locked');
      document.body.classList.remove('is-locked');
      document.body.style.top = '';
      window.scrollTo(0, scrollY);
    }

    function openMenu(){
      mobileOverlay.classList.add('open');
      mobileOverlay.setAttribute('aria-hidden','false');
      burgerBtn.setAttribute('aria-expanded','true');
      lockScroll();
      const firstBtn = mobileOverlay.querySelector('.mobile-menu-btn');
      if (firstBtn) firstBtn.focus();
    }

    function hideMenu(){
      mobileOverlay.classList.remove('open');
      mobileOverlay.setAttribute('aria-hidden','true');
      burgerBtn.setAttribute('aria-expanded','false');
      unlockScroll();
      burgerBtn.focus();
    }

    if (burgerBtn && mobileOverlay && closeMenu){
      burgerBtn.addEventListener('click', openMenu);
      closeMenu.addEventListener('click', hideMenu);
      mobileOverlay.addEventListener('click', (e)=>{ if (e.target === mobileOverlay) hideMenu(); });
      document.addEventListener('keydown', (e)=>{ if (mobileOverlay.classList.contains('open') && e.key === 'Escape'){ hideMenu(); } });
      mobileOverlay.querySelectorAll('.mobile-menu-btn').forEach(btn=>{
        btn.addEventListener('click', ()=>{
          const href = btn.getAttribute('data-nav');
          if (href) window.location.href = href;
        });
      });

      // Evita scroll por gesto dentro del overlay en móvil (por si acaso)
      mobileOverlay.addEventListener('touchmove', (e)=>{ e.preventDefault(); }, { passive: false });
    }
  });
</script>

</body>
</html>

